---
phase: 01-monorepo-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [package.json, turbo.json, tsconfig.json, tsconfig.base.json, apps/web/package.json, apps/web/tsconfig.json, packages/api/package.json, packages/api/tsconfig.json, packages/shared/package.json, packages/shared/tsconfig.json, packages/shared/src/index.ts, .gitignore, .env.example]
autonomous: true
user_setup: []

must_haves:
  truths:
    - "bun install succeeds at repo root"
    - "TypeScript resolves workspace packages"
    - "turbo dev starts without errors"
  artifacts:
    - path: "package.json"
      provides: "Root workspace configuration"
      contains: "workspaces"
    - path: "turbo.json"
      provides: "Turborepo orchestration"
      contains: "tasks"
    - path: "tsconfig.json"
      provides: "Root TypeScript config"
      contains: "references"
    - path: "packages/shared/package.json"
      provides: "Shared package definition"
      contains: "@alvarocortes/shared"
  key_links:
    - from: "package.json"
      to: "apps/*, packages/*"
      via: "Bun workspaces"
      pattern: '"workspaces".*apps.*packages'
    - from: "apps/web/package.json"
      to: "@alvarocortes/shared"
      via: "workspace dependency"
      pattern: '"@alvarocortes/shared".*workspace'
---

<objective>
Scaffold the BHVR monorepo with Bun workspaces, Turborepo, and TypeScript configuration.

Purpose: Establish the foundational project structure that all other plans build upon.
Output: Working monorepo with apps/web, packages/api, packages/shared directories and root orchestration.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/research/STACK.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create root workspace configuration</name>
  <files>package.json, turbo.json, .gitignore, .env.example</files>
  <action>
Create root package.json with Bun workspaces:
```json
{
  "name": "alvarocortes",
  "private": true,
  "workspaces": ["apps/*", "packages/*"],
  "scripts": {
    "dev": "turbo dev",
    "build": "turbo build",
    "test": "vitest",
    "lint": "turbo lint",
    "type-check": "turbo type-check"
  },
  "devDependencies": {
    "turbo": "^2.5.5",
    "typescript": "^5.7.2",
    "vitest": "^3.2.0"
  }
}
```

Create turbo.json for orchestration:
```json
{
  "$schema": "https://turbo.build/schema.json",
  "tasks": {
    "build": {
      "dependsOn": ["^build"],
      "outputs": ["dist/**"]
    },
    "dev": {
      "cache": false,
      "persistent": true
    },
    "lint": {},
    "type-check": {
      "dependsOn": ["^build"]
    },
    "test": {
      "dependsOn": ["^build"]
    }
  }
}
```

Update .gitignore to include:
- node_modules/
- dist/
- .turbo/
- .env.local
- *.log

Create .env.example with placeholder structure.
  </action>
  <verify>cat package.json && cat turbo.json</verify>
  <done>Root package.json has workspaces, turbo.json has tasks defined</done>
</task>

<task type="auto">
  <name>Task 2: Create TypeScript configuration</name>
  <files>tsconfig.json, tsconfig.base.json</files>
  <action>
Create tsconfig.base.json with shared compiler options:
```json
{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["ES2022", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "noEmit": true,
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedIndexedAccess": true,
    "skipLibCheck": true,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true
  }
}
```

Create root tsconfig.json with project references:
```json
{
  "files": [],
  "references": [
    { "path": "apps/web" },
    { "path": "packages/api" },
    { "path": "packages/shared" }
  ]
}
```
  </action>
  <verify>cat tsconfig.base.json && cat tsconfig.json</verify>
  <done>Base config has strict settings, root config has project references</done>
</task>

<task type="auto">
  <name>Task 3: Create workspace directory structure and package.json files</name>
  <files>apps/web/package.json, apps/web/tsconfig.json, packages/api/package.json, packages/api/tsconfig.json, packages/shared/package.json, packages/shared/tsconfig.json, packages/shared/src/index.ts</files>
  <action>
Create apps/web/package.json (minimal, will be expanded in Plan 01-02):
```json
{
  "name": "@alvarocortes/web",
  "private": true,
  "type": "module",
  "scripts": {
    "dev": "echo 'Configured in Plan 01-02'",
    "build": "echo 'Configured in Plan 01-02'",
    "lint": "echo 'Configured in Plan 01-04'",
    "type-check": "tsc --noEmit"
  },
  "dependencies": {
    "@alvarocortes/shared": "workspace:*"
  },
  "devDependencies": {
    "typescript": "^5.7.2"
  }
}
```

Create apps/web/tsconfig.json:
```json
{
  "extends": "../../tsconfig.base.json",
  "compilerOptions": {
    "composite": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["src/**/*"],
  "references": [
    { "path": "../../packages/shared" }
  ]
}
```

Create packages/api/package.json (minimal, will be expanded in Plan 01-03):
```json
{
  "name": "@alvarocortes/api",
  "private": true,
  "type": "module",
  "main": "src/index.ts",
  "types": "src/index.ts",
  "scripts": {
    "dev": "echo 'Configured in Plan 01-03'",
    "build": "echo 'Configured in Plan 01-03'",
    "lint": "echo 'Configured in Plan 01-04'",
    "type-check": "tsc --noEmit"
  },
  "dependencies": {
    "@alvarocortes/shared": "workspace:*"
  },
  "devDependencies": {
    "typescript": "^5.7.2"
  }
}
```

Create packages/api/tsconfig.json:
```json
{
  "extends": "../../tsconfig.base.json",
  "compilerOptions": {
    "composite": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["src/**/*"],
  "references": [
    { "path": "../shared" }
  ]
}
```

Create packages/shared/package.json:
```json
{
  "name": "@alvarocortes/shared",
  "private": true,
  "type": "module",
  "main": "src/index.ts",
  "types": "src/index.ts",
  "exports": {
    ".": {
      "types": "./src/index.ts",
      "import": "./src/index.ts"
    }
  },
  "scripts": {
    "lint": "echo 'Configured in Plan 01-04'",
    "type-check": "tsc --noEmit"
  },
  "dependencies": {
    "zod": "^3.24.0"
  },
  "devDependencies": {
    "typescript": "^5.7.2"
  }
}
```

Create packages/shared/tsconfig.json:
```json
{
  "extends": "../../tsconfig.base.json",
  "compilerOptions": {
    "composite": true,
    "declaration": true,
    "declarationMap": true,
    "baseUrl": ".",
    "outDir": "dist"
  },
  "include": ["src/**/*"]
}
```

Create packages/shared/src/index.ts with initial export:
```typescript
// Shared types and utilities for alvarocortes monorepo
export const VERSION = "0.0.1"
```
  </action>
  <verify>ls -la apps/web/ && ls -la packages/api/ && ls -la packages/shared/src/</verify>
  <done>All workspace directories exist with package.json and tsconfig.json files</done>
</task>

<task type="auto">
  <name>Task 4: Install dependencies and verify monorepo</name>
  <files>bun.lockb</files>
  <action>
Run `bun install` at root to install all dependencies and link workspaces.
Verify workspace linking with `bun pm ls --all`.
Run `bunx turbo build --dry-run` to verify Turborepo sees all packages.
  </action>
  <verify>bun install && bunx turbo build --dry-run</verify>
  <done>bun install succeeds, turbo recognizes all workspaces</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `bun install` succeeds at repo root
- [ ] `bunx turbo build --dry-run` shows all 3 packages
- [ ] TypeScript project references resolve (no tsconfig errors)
- [ ] packages/shared can be imported from apps/web and packages/api
</verification>

<success_criteria>
- All tasks completed
- Monorepo structure matches STACK.md specification
- Bun workspaces configured and functional
- Turborepo orchestration ready
- TypeScript project references working
</success_criteria>

<output>
After completion, create `.planning/phases/01-monorepo-foundation/01-01-SUMMARY.md`
</output>
