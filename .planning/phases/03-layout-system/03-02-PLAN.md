---
phase: 03-layout-system
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - apps/web/src/components/Layout.tsx
  - apps/web/src/App.tsx
  - apps/web/src/styles/main.css
autonomous: false

# Goal-backward verification
must_haves:
  truths:
    - "Header appears immediately on page load"
    - "Main content fades in with opacity transition when ready"
    - "Footer is hidden until user scrolls to bottom"
    - "No layout shifts during loading sequence"
  artifacts:
    - path: "apps/web/src/components/Layout.tsx"
      provides: "Layout wrapper orchestrating header/content/footer with progressive loading"
      min_lines: 40
      exports: ["Layout"]
    - path: "apps/web/src/App.tsx"
      provides: "Updated App using Layout component"
      contains: "Layout"
  key_links:
    - from: "Layout.tsx"
      to: "Header.tsx"
      via: "import and render"
      pattern: "import.*Header"
    - from: "Layout.tsx"
      to: "Footer.tsx"
      via: "import and conditional render"
      pattern: "import.*Footer"
    - from: "Layout.tsx"
      to: "framer-motion"
      via: "motion components for transitions"
      pattern: "motion\\."
    - from: "App.tsx"
      to: "Layout.tsx"
      via: "wraps content"
      pattern: "<Layout"
---

<objective>
Create Layout component that orchestrates progressive loading with Header, content, and Footer.

Purpose: Implement the "fluido y profesional" loading experience per PROJECT.md core value. Header loads first, content fades in, footer reveals on scroll.
Output: Integrated layout system ready for Home page content.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
@./.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/research/STACK.md

# Prior plan provides Header and Footer components:
@.planning/phases/03-layout-system/03-01-SUMMARY.md

# Current source files:
@apps/web/src/App.tsx
@apps/web/src/styles/main.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Layout component with progressive loading</name>
  <files>apps/web/src/components/Layout.tsx</files>
  <action>
    Create Layout component that orchestrates the loading sequence:

    **Structure:**
    ```tsx
    import { motion } from 'framer-motion'
    import { useState, useEffect, ReactNode } from 'react'
    import { Header } from './Header'
    import { Footer } from './Footer'

    interface LayoutProps {
      children: ReactNode
    }

    export function Layout({ children }: LayoutProps) {
      // State for content ready and footer visibility
      const [contentReady, setContentReady] = useState(false)
      const [showFooter, setShowFooter] = useState(false)

      // ... implementation
    }
    ```

    **Loading sequence (per REQUIREMENTS):**
    1. **LOAD-01**: Header renders immediately (no delay, no animation on mount)
    2. **LOAD-02**: Content fades in with opacity transition after brief delay (~100-200ms)
    3. **LOAD-03**: Footer appears after content is visible
    4. **LOAD-04**: No layout shifts - use fixed heights or min-heights

    **Footer scroll reveal (LAYOUT-04):**
    Use IntersectionObserver or scroll event to detect when user reaches bottom.
    When bottom reached (or near bottom), reveal Footer.
    Footer can use Framer Motion for smooth reveal animation (slide up or fade in).

    **Implementation approach:**
    - Header: Render directly, no motion wrapper needed for initial render
    - Content: Wrap in `motion.main` with opacity animation
    - Footer: Use conditional render + motion for reveal

    **Framer Motion patterns (from STACK.md):**
    - Use `motion.main` for content wrapper
    - Use `AnimatePresence` for footer enter/exit
    - Simple opacity/y animations for smooth transitions

    **Anti-patterns to AVOID:**
    - Don't use loading spinners (not in requirements)
    - Don't delay Header render
    - Don't use complex spring physics that cause bouncing
    - Don't add unnecessary animation on every render

    **CSS considerations:**
    - Main content area should have min-height to prevent layout shift
    - Footer should not affect layout when hidden (use absolute/fixed positioning or AnimatePresence)
  </action>
  <verify>
    - File exists at apps/web/src/components/Layout.tsx
    - `bun run type-check` passes
    - Imports Header, Footer, and framer-motion
    - Exports Layout function
  </verify>
  <done>Layout component created with progressive loading orchestration</done>
</task>

<task type="auto">
  <name>Task 2: Update App.tsx to use Layout</name>
  <files>apps/web/src/App.tsx</files>
  <action>
    Update App.tsx to use the new Layout component:

    ```tsx
    import { Layout } from "./components/Layout"

    export function App() {
      return (
        <Layout>
          {/* Placeholder content - will be replaced by Home page in Phase 4 */}
          <div className="flex items-center justify-center min-h-[calc(100vh-theme(spacing.16))]">
            <div className="text-center">
              <h1 className="text-4xl font-bold mb-4">Alvaro Cortes</h1>
              <p className="text-neutral-400">Portfolio en construccion</p>
            </div>
          </div>
        </Layout>
      )
    }
    ```

    **Key changes:**
    - Import and wrap content with Layout
    - Remove background/text color classes (Layout handles overall styling)
    - Keep placeholder content centered
    - Use calc() for min-height to account for header height

    The VERSION import from shared can be removed for now (was just for testing).
  </action>
  <verify>
    - App.tsx imports Layout
    - App.tsx wraps content in Layout
    - `bun run type-check` passes
    - `bun run build` succeeds
  </verify>
  <done>App.tsx updated to use Layout wrapper</done>
</task>

<task type="auto">
  <name>Task 3: Update global styles for layout support</name>
  <files>apps/web/src/styles/main.css</files>
  <action>
    Update main.css to support the layout system:

    ```css
    @import "tailwindcss";

    /* Ensure body fills viewport and allows proper footer positioning */
    html, body, #root {
      min-height: 100vh;
    }

    body {
      background-color: theme('colors.neutral.900');
      color: white;
    }

    /* Smooth scrolling for better UX */
    html {
      scroll-behavior: smooth;
    }
    ```

    **Purpose:**
    - Ensure full viewport height for proper layout
    - Set default dark background (matches design from App.tsx)
    - Enable smooth scrolling for scroll-to-bottom behavior
    - Remove need for inline bg/text classes everywhere
  </action>
  <verify>
    - main.css updated with new styles
    - `bun run build` succeeds
  </verify>
  <done>Global styles updated for layout system support</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete layout system with Header, Footer, and progressive loading</what-built>
  <how-to-verify>
    1. Run: `cd apps/web && bun dev`
    2. Visit: http://localhost:5173
    3. Verify loading sequence:
       - Header should appear IMMEDIATELY (no delay)
       - Content should fade in smoothly (opacity transition)
       - Scroll to bottom of page
       - Footer should reveal when you reach the bottom
    4. Check for layout shifts:
       - Resize window - no jumping/shifting should occur
       - Refresh page - layout should be stable
    5. Verify visual consistency:
       - Header has logo/name on left, "Inicio" on right
       - Dark theme throughout (neutral-900 background)
       - Footer shows copyright text
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe any issues with the loading sequence or layout</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `bun install` succeeds at repo root
- [ ] `bun run type-check` passes in apps/web
- [ ] `bun run build` succeeds
- [ ] Layout.tsx exists with progressive loading logic
- [ ] App.tsx uses Layout wrapper
- [ ] Human verification of loading sequence passed
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Header appears immediately on page load
- Content fades in smoothly
- Footer reveals on scroll to bottom
- No layout shifts during transitions
- Human approved visual/functional behavior
</success_criteria>

<output>
After completion, create `.planning/phases/03-layout-system/03-02-SUMMARY.md`
</output>
